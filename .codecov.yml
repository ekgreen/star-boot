# üìä Codecov Configuration - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞
#
# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫ –º–µ–∂–¥—É PR –∏ push —Å–æ–±—ã—Ç–∏—è–º–∏
# –†–∞–∑–¥–µ–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É PR –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –≤–µ—Ç–∫–∏

# –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è
coverage:
  precision: 2
  round: down
  range: "70...100"

  # –°—Ç–∞—Ç—É—Å—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è
  status:
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
    project:
      default:
        target: 80%                    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
        threshold: 1%                  # –î–æ–ø—É—Å—Ç–∏–º–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ
        base: auto                     # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–∑—ã
        if_ci_failed: error           # –°—Ç–∞—Ç—É—Å –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ CI
        only_pulls: false             # –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∏ PR –∏ push

      # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è PR
      pr-validation:
        target: 80%
        threshold: 2%                  # –ë–æ–ª–µ–µ –º—è–≥–∫–∏–π –ø–æ—Ä–æ–≥ –¥–ª—è PR
        base: auto
        if_ci_failed: error
        only_pulls: true              # –¢–æ–ª—å–∫–æ –¥–ª—è PR

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (–ø–∞—Ç—á)
    patch:
      default:
        target: 75%                   # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
        threshold: 5%                 # –î–æ–ø—É—Å—Ç–∏–º–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –¥–ª—è –ø–∞—Ç—á–∞
        base: auto
        only_pulls: true              # –¢–æ–ª—å–∫–æ –¥–ª—è PR

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤ PR
comment:
  layout: "reach, diff, flags, files"
  behavior: default
  require_changes: false            # –ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–∂–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  require_base: false              # –ù–µ —Ç—Ä–µ–±–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∫–æ–º–º–∏—Ç
  require_head: true               # –¢—Ä–µ–±–æ–≤–∞—Ç—å head –∫–æ–º–º–∏—Ç
  after_n_builds: 1                # –ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Å–±–æ—Ä–∫–∏

# GitHub –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
github_checks:
  annotations: true                 # –î–æ–±–∞–≤–ª—è—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∫ –∫–æ–¥—É

# –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É PR –∏ push
flag_management:
  default_rules:
    carryforward: true              # –ü–µ—Ä–µ–Ω–æ—Å–∏—Ç—å —Ñ–ª–∞–≥–∏ –º–µ–∂–¥—É –±–∏–ª–¥–∞–º–∏

  individual_flags:
    # –§–ª–∞–≥ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ PR
    - name: pr-validation
      paths:
        - "src/"
      carryforward: false

    # –§–ª–∞–≥ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –≤–µ—Ç–∫–∏
    - name: main-branch
      paths:
        - "src/"
      carryforward: true

    # –§–ª–∞–≥ –¥–ª—è unit —Ç–µ—Å—Ç–æ–≤
    - name: unittests
      paths:
        - "src/"
      carryforward: true

# –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
ignore:
  # Spring Boot —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
  - "**/*Application.java"          # –ì–ª–∞–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - "**/config/**"                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã
  - "**/dto/**"                     # Data Transfer Objects
  - "**/entity/**"                  # JPA —Å—É—â–Ω–æ—Å—Ç–∏
  - "**/autoconfigure/**"           # –ê–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Spring Boot

  # Lombok –∏ generated –∫–æ–¥
  - "**/*$*"                        # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–ª–∞—Å—Å—ã –æ—Ç Lombok
  - "**/generated-sources/**"       # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

  # Build –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
  - "**/target/**"                  # Maven build –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
  - "**/build/**"                   # Gradle build –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

  # –¢–µ—Å—Ç–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã
  - "**/src/test/resources/**"      # –¢–µ—Å—Ç–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã

# –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç—á–µ—Ç–æ–≤
parsers:
  gcov:
    branch_detection:
      conditional: yes
      loop: yes
      method: no
      macro: no

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
notify:
  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Slack (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  slack:
    default:
      only_pulls: true
      message: "Coverage report for {{owner}}/{{repo}}"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ YAML –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
codecov:
  require_ci_to_pass: yes           # –¢—Ä–µ–±–æ–≤–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–π CI
  notify:
    after_n_builds: 1               # –£–≤–µ–¥–æ–º–ª—è—Ç—å –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Å–±–æ—Ä–∫–∏
    wait_for_ci: yes                # –ñ–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è CI
